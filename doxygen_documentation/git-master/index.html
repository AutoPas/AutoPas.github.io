<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AutoPas</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="https://raw.githubusercontent.com/AutoPas/AutoPas/master/docs/graphics/AutoPasLogo_Small.svg">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript">
    function doOnLoad() {
        if (!window.location.href.startsWith("file://")) {
            // this is only done if we are on an actual webserver, where we expect to have ../autopas_onpageload.js
            var script = document.createElement('script');
            script.onload = function () {
                on_page_load();
            };
            script.src = "../onpageload.js";
            document.head.appendChild(script); //or something of the likes
        } else {
            var version_selector = document.getElementById("autopas_version_selector");
            var option = document.createElement("option");
            option.text = "local";
            option.value = "local";
            version_selector.appendChild(option);
        }
    }
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body onload="doOnLoad()">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
	<!--BEGIN VERSION INFO-->
	<div id="version selector">
        <label for="autopas_version_selector">Version:</label>
        <select id="autopas_version_selector">
        </select>
	</div>
	<!--END VERSION INFO-->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname"><a href="https://autopas.github.io/"><img style="height: 56px;" alt="AutoPas" src="AutoPasLogo_Large.png"/></a>
   &#160;<span id="projectnumber">0.1.0-f9a4798</span>
   </div>
  </td>
     <td style="float:right"><div id="githublink"><a href="https://github.com/AutoPas/AutoPas"><img border="0" alt="GitHub" src="https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png" height="56px"></a></div></td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title"><img src="https://raw.githubusercontent.com/AutoPas/AutoPas/master/docs/graphics/AutoPasLogo_Large.png" alt="AutoPas" title="Title" class="inline"/> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__github_workspace_README"></a> AutoPas is a node-level auto-tuned particle simulation library developed in the context of the <a href="http://www.talpas.de"><b>TaLPas</b></a> project. <a href="https://www5.in.tum.de/jenkins/mardyn/job/AutoPas-Multibranch/job/master/"><img src="https://www5.in.tum.de/jenkins/mardyn/buildStatus/icon?job=AutoPas-Multibranch/master" alt="Build Status" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Documentation</h1>
<p>The documentation can be found at our website: <a href="https://autopas.github.io/doxygen_documentation/git-master/">https://autopas.github.io/doxygen_documentation/git-master/</a></p>
<p>Alternatively you can build the documentation on your own:</p><ul>
<li>requirements: <a href="http://www.doxygen.nl/">Doxygen</a></li>
<li><code>make doc_doxygen</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md2"></a>
Requirements</h1>
<ul>
<li>cmake 3.14 or newer</li>
<li>make (build-essentials) or ninja</li>
<li>a c++17 compiler (gcc7, clang8 and icpc 2019 are tested)</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Building AutoPas</h1>
<p>build instructions for make: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>if you want to use another compiler, specify it at the first cmake call, e.g.: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">CC=clang CXX=clang++ cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>if you would like to use ninja instead of make: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake -G Ninja ..</div>
<div class="line">ninja</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
Building AutoPas on a Cluster</h2>
<p>HPC clusters often use module systems. CMake is sometimes not able to correctly detect the compiler you wished to use. If a wrong compiler is found please specify the compiler explicitly, e.g. for gcc: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">CC=`which gcc` CXX=`which g++` cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Testing</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
Running Tests</h2>
<p>to run tests: </p><div class="fragment"><div class="line">make test</div>
<div class="line"># or</div>
<div class="line">ninja test</div>
</div><!-- fragment --><p>or using the ctest environment: </p><div class="fragment"><div class="line">ctest</div>
</div><!-- fragment --><p>to get verbose output: </p><div class="fragment"><div class="line">ctest --verbose</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7"></a>
How to run specific tests</h3>
<p>use the &ndash;gtest_filter variable: </p><div class="fragment"><div class="line">./tests/testAutopas/runTests --gtest_filter=ArrayMathTest.testAdd*</div>
</div><!-- fragment --><p>or use the GTEST_FILTER environment variable: </p><div class="fragment"><div class="line">GTEST_FILTER=&quot;ArrayMathTest.testAdd*&quot; ctest --verbose</div>
</div><!-- fragment --><p>or <code>ctest</code> arguments like <code>-R</code> (run tests matching regex) and <code>-E</code> (exclude tests matching regex) </p><div class="fragment"><div class="line">ctest -R &#39;Array.*testAdd&#39; -E &#39;Double&#39;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Debugging Tests</h2>
<p>Find out the command to start your desired test with <code>-N</code> aka. <code>--show-only</code>: </p><div class="fragment"><div class="line">ctest -R &#39;Array.*testAdd&#39; -N</div>
</div><!-- fragment --><p>Start the test with <code>gdb</code> </p><div class="fragment"><div class="line">gdb --args ${TestCommand}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
Examples</h1>
<p>As AutoPas is only a library for particle simulations it itself is not able to run simulations. We have, however, included a variety of examples in the <b>examples</b> directory. The examples include:</p><ul>
<li>Molecular dynamics simulations with 1 centered Lennard-Jones particles.</li>
<li>Smoothed particle hydrodynamics simulations</li>
<li>Gravity simulations</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Using AutoPas</h1>
<p>Steps to using AutoPas in your particle simulation program:</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Defining a Custom Particle Class</h2>
<p>First you will need to define a particle class. For that we provide some basic Particle classes defined in <code>src/particles/</code> that you can use either directly or you can write your own Particle class by inheriting from one of the provided classes. </p><div class="fragment"><div class="line"><span class="keyword">class </span>SPHParticle : <span class="keyword">public</span> <a class="code" href="classautopas_1_1ParticleBase.html">autopas::Particle</a> {</div>
<div class="line"> </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
Functors</h2>
<p>Once you have defined your particle you can start with functors; </p>
<h3><a class="anchor" id="autotoc_md13"></a>
Definition</h3>
<p>TODO </p>
<h3><a class="anchor" id="autotoc_md14"></a>
Usage</h3>
<p>TODO</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Particle Ownership</h2>
<p>Particles saved in an AutoPas container can be one of two possible states:</p><ul>
<li>owned: Particles that belong to this AutoPas instance. These particles are either inside of the boundary of the AutoPas instance or very close to the boundary (less than a distance of skin/2 away). If a particle is added via <code>addParticle()</code>, it is automatically added as an owned particle. An owned particle can explicitly be removed by deleting the particle using an iterator (<code>autoPas.deleteParticle(iterator)</code>). On an update of the AutoPas container (using <code>updateContainer()</code>) owned particles that move outside of the boundary of its parent AutoPas container are returned.</li>
<li>halo: Particles that do not belong to the current AutoPas instance. These normally are ghost particles arising from either periodic boundary conditions or particles of a neighboring AutoPas object (if you split the entire domain over multiple AutoPas objects, i.e., you use a domain decomposition algorithm). The halo particles are needed for the correct calculation of the pairwise forces. On update of the AutoPas container, halo particles are deleted (note that not every call to <code>updateContainer()</code> does this!, see <a href="#simulation-loop">Simulation Loop</a>).</li>
</ul>
<h2><a class="anchor" id="autotoc_md16"></a>
Iterating Through Particles</h2>
<p>Iterators to iterate over particle are provided. The particle can be accesses using <code>iter-&gt;</code> (<code>*iter</code> is also possible). When created inside a OpenMP parallel region, work is automatically spread over all iterators. </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span> iter = autoPas.begin(); iter.isValid(); ++iter) {</div>
<div class="line">  <span class="comment">// user code:</span></div>
<div class="line">  <span class="keyword">auto</span> position = iter-&gt;getR();</div>
<div class="line">}</div>
</div><!-- fragment --><p>For convenience the <code>end()</code> method is also implemented for the AutoPas class. </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span> iter = autoPas.begin(); iter != autoPas.end(); ++iter) {</div>
<div class="line">  <span class="comment">// user code:</span></div>
<div class="line">  <span class="keyword">auto</span> position = iter-&gt;getR();</div>
<div class="line">}</div>
</div><!-- fragment --><p>You might also use range-based for loops: </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; particle : autoPas) {</div>
<div class="line">  <span class="comment">// user code:</span></div>
<div class="line">  <span class="keyword">auto</span> position = particle.getR();</div>
<div class="line">}</div>
</div><!-- fragment --><p>To iterate over a subset of particles, the <code>getRegionIterator(lowCorner, highCorner)</code> method can be used: </p><div class="fragment"><div class="line"><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="keywordflow">for</span>(<span class="keyword">auto</span> iter = autoPas.getRegionIterator(lowCorner, highCorner); iter != autoPas.end(); ++iter) {</div>
<div class="line">  <span class="comment">// user code:</span></div>
<div class="line">  <span class="keyword">auto</span> position = iter-&gt;getR();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Both <code>begin()</code> and <code>getRegionIterator()</code> can also take the additional parameter <code>IteratorBehavior</code>, which indicates over which particles the iteration should be performed. </p><div class="fragment"><div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42">IteratorBehavior</a> {</div>
<div class="line">  <a class="code" href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42ac7100cec3dab7c9f031d06e44cdd4993">haloOnly</a>,          </div>
<div class="line">  <a class="code" href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42a30bdce7517eacf5a795a2b165e4a4eb8">ownedOnly</a>,         </div>
<div class="line">  <a class="code" href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42ae92b03f5be5a06c5bb4c5f72ffd26f84">haloAndOwned</a>,      </div>
<div class="line">  <a class="code" href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42aa79bf7e94374210cd4bdb537ab8f66ad">haloOwnedAndDummy</a>  </div>
<div class="line">};</div>
</div><!-- fragment --><p>The default parameter is <code>haloAndOwned</code>, which is also used for range-based for loops.</p>
<p>Analogously to <code>begin()</code>, <code>cbegin()</code> is also defined, which guarantees to return a <code>const_iterator</code>.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Simulation Loop</h2>
<p>One simulation loop should always consist of the following phases:</p>
<ol type="1">
<li><p class="startli">Updating the Container: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> [invalidParticles, updated] = autoPas.updateContainer();</div>
</div><!-- fragment --><p class="startli">This call will potentially trigger an update of the container inside of AutoPas. The update will be performed if either</p>
<p class="startli">a. The AutoTuner collected enough samples for the current configuration and will move to the next one OR</p>
<p class="startli">b. The rebuild frequency of the container is reached.</p>
<p class="startli">If the update is performed, the returned bool <code>updated</code> is <code>true</code>. The returned vector <code>invalidParticles</code> consists of the particles that are not anymore within the boundaries of this container and hence are deleted from it. These are particles that were previously owned by this AutoPas container but have left the boundary of this container, i.e., their current position resides outside of the container.</p>
<p class="startli">If the update is not performed, <code>updated</code> will be false and the returned vector <code>invalidParticles</code> will be empty. An update is sometimes skipped to ensure that containers do not change, which allows containers to reuse neighbor lists thus enabling better performance.</p>
</li>
<li>Handling the leaving particles<ul>
<li>This step can be skipped if <code>updated</code> was false. If you use multiple MPI instances, you have to ensure that all instances rebuild during the same time step. This is guaranteed if the sampling frequency is the same as (or a multiple of) the rebuild frequency.</li>
<li>Apply boundary conditions on them</li>
<li>Potentially send them to other mpi-processes, skip this if MPI is not needed</li>
<li>Add them to the containers using ```cpp autoPas.addParticle(particle) ```</li>
</ul>
</li>
<li>Handle halo particles:<ul>
<li>This step always has to be performed, even if <code>updated</code> was false.</li>
<li>Identify the halo particles by use of AutoPas' iterators and send them in a similar way as the leaving particles.</li>
<li>Add the particles as haloParticles using ```cpp autoPas.addOrUpdateHaloParticle(haloParticle) ```</li>
</ul>
</li>
<li>Perform an iteratePairwise step. <div class="fragment"><div class="line">autoPas.iteratePairwise(functor);</div>
</div><!-- fragment --></li>
</ol>
<h2><a class="anchor" id="autotoc_md18"></a>
Using multiple functors</h2>
<p>AutoPas is able to work with simulation setups using multiple functors that describe different forces. A good demonstration for that is the sph example found under examples/sph or examples/sph-mpi. There exist some things you have to be careful about when using multiple functors:</p><ul>
<li>If you use multiple functors it is necessary that all functors support the same newton3 options. If there is one functor not supporting newton3, you have to disable newton3 support for AutoPas by calling <div class="fragment"><div class="line">autoPas.setAllowedNewton3Options({<span class="keyword">false</span>});</div>
</div><!-- fragment --></li>
<li>If you have <code>n</code> functors within one iteration and update the particle position only at the end or start of the iteration, the rebuildFrequency and the samplingRate have to be a multiple of <code>n</code>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Inserting additional particles</h2>
<p>Before inserting additional particles (e.g. through a grand-canonical thermostat ), you always have to enforce a containerUpdate on ALL AutoPas instances, i.e., on all mpi processes, by calling </p><div class="fragment"><div class="line">autoPas.updateContainerForced();</div>
</div><!-- fragment --><p>This will invalidate the internal neighbor lists and containers.</p>
<h1><a class="anchor" id="autotoc_md20"></a>
Developing AutoPas</h1>
<p>Please look at our <a href="https://github.com/AutoPas/AutoPas/blob/master/.github/CONTRIBUTING.md">contribution guidelines</a>.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Acknowledgements</h1>
<p>This work was financially supported by:</p><ul>
<li>the Federal Ministry of Education and Research, Germany, project “Task-based load balancing and auto-tuning in particle simulations” (TaLPas) 8 , grant numbers 01IH16008A and 01IH16008B.</li>
</ul>
<h1><a class="anchor" id="autotoc_md22"></a>
Papers to cite</h1>
<ul>
<li>F. A. Gratl, S. Seckler, N. Tchipev, H.-J. Bungartz and P. Neumann: <a href="https://ieeexplore.ieee.org/document/8778280">AutoPas: Auto-Tuning for Particle Simulations</a> <a href="https://mediatum.ub.tum.de/services/export/node/1535848/?format=template_test&amp;mask=bibtex&amp;lang=de&amp;template=$$[defaultexport]$$&amp;mimetype=text/plain">BibTeX</a> <a href="https://mediatum.ub.tum.de/1535848">MediaTum</a>, In 2019 IEEE International Parallel and Distributed Processing Symposium Workshops (IPDPSW), Rio de Janeiro, May 2019. </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="anamespaceautopas_html_a520fefd51e4555074cd16e7c3fd19c42ac7100cec3dab7c9f031d06e44cdd4993"><div class="ttname"><a href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42ac7100cec3dab7c9f031d06e44cdd4993">autopas::haloOnly</a></div><div class="ttdeci">@ haloOnly</div><div class="ttdoc">iterate only over halo particles</div><div class="ttdef"><b>Definition:</b> ParticleIteratorInterface.h:15</div></div>
<div class="ttc" id="anamespaceautopas_html_a520fefd51e4555074cd16e7c3fd19c42a30bdce7517eacf5a795a2b165e4a4eb8"><div class="ttname"><a href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42a30bdce7517eacf5a795a2b165e4a4eb8">autopas::ownedOnly</a></div><div class="ttdeci">@ ownedOnly</div><div class="ttdoc">iterate only over owned particles</div><div class="ttdef"><b>Definition:</b> ParticleIteratorInterface.h:16</div></div>
<div class="ttc" id="anamespaceautopas_html_a520fefd51e4555074cd16e7c3fd19c42aa79bf7e94374210cd4bdb537ab8f66ad"><div class="ttname"><a href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42aa79bf7e94374210cd4bdb537ab8f66ad">autopas::haloOwnedAndDummy</a></div><div class="ttdeci">@ haloOwnedAndDummy</div><div class="ttdoc">iterate over both halo and owned particles and also dummy particles</div><div class="ttdef"><b>Definition:</b> ParticleIteratorInterface.h:18</div></div>
<div class="ttc" id="anamespaceautopas_html_a520fefd51e4555074cd16e7c3fd19c42ae92b03f5be5a06c5bb4c5f72ffd26f84"><div class="ttname"><a href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42ae92b03f5be5a06c5bb4c5f72ffd26f84">autopas::haloAndOwned</a></div><div class="ttdeci">@ haloAndOwned</div><div class="ttdoc">iterate over both halo and owned particles</div><div class="ttdef"><b>Definition:</b> ParticleIteratorInterface.h:17</div></div>
<div class="ttc" id="aclassautopas_1_1ParticleBase_html"><div class="ttname"><a href="classautopas_1_1ParticleBase.html">autopas::ParticleBase</a></div><div class="ttdoc">Minimal definition of a basic particle.</div><div class="ttdef"><b>Definition:</b> ParticleBase.h:32</div></div>
<div class="ttc" id="anamespaceautopas_html_a520fefd51e4555074cd16e7c3fd19c42"><div class="ttname"><a href="namespaceautopas.html#a520fefd51e4555074cd16e7c3fd19c42">autopas::IteratorBehavior</a></div><div class="ttdeci">IteratorBehavior</div><div class="ttdoc">Enum to specify the behavior of an iterator.</div><div class="ttdef"><b>Definition:</b> ParticleIteratorInterface.h:14</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
